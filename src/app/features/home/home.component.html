<div class="search">
  <app-ingredients-input [ingredients]="ingredients()" (ingredientsChange)="ingredients.set($event)" />
  <button mat-stroked-button color="primary" [disabled]="!ingredients().length" (click)="search()">Search recipe</button>
</div>

@if (recipes().length) {
  <swiper
    #swiper
    [config]="config"
    [effect]="'cards'"
    (afterInit)="afterInitSwiper()"
    (slideChange)="onSlideChange($event)"
  >
    @for (recipe of recipes(); track recipe.name; let i = $index) {
      <ng-template swiperSlide>

        <!-- TODO componentizar recipe-card -->

        <div class="recipe-card">
          <p class="name">{{recipe.name}}</p>
          <img [src]="recipeImg(recipe.image)" alt="">
          <div class="info">
            <div class="item">
              <span class="title">Level</span>
              <span>{{recipe.info[0]}}</span>
            </div>
            <div class="item">
              <span class="title">Time</span>
              <span>{{recipe.info[1]}}</span>
            </div>
          </div>
          <button
            mat-button
            color="primary"
            routerLinkActive="router-link-active"
            [routerLink]="['/recipes', recipe.anchor]"
          >
            View recipe
          </button>
        </div>
      </ng-template>
    }
  </swiper>
} @else {
  <div class="container-placeholder">
    @if (firstSearch) {
      <span class="title">¡Busca recetas con los ingredientes que quieras!</span>
      <img class="placeholder-img" src="assets\images\chefs.png" alt="">
    } @else if (loading) {
      <img class="placeholder-gif" src="assets\images\loading-black.gif" alt="">
    } @else {
      <div>
        <img class="placeholder-gif" src="assets\images\not-found-black.gif" alt="">
        <p style="text-align: center; margin-bottom: 0;">Not found</p>
      </div>
    }
  </div>
}

<h3 class="section-title">Últimas 10 búsquedas</h3>

<div class="container-records">
  @if (records().length) {
    @for (record of records(); track record._id) {
  
      <!-- TODO componentizar record-card -->
  
      <div matRipple class="record-card" (click)="searchRecord(record.ingredients)">
        <img [src]="recipeImg(record.image)" alt="">
        <div class="chips-container">
          @for (ingredient of record.ingredients; track ingredient) {
            <span class="chip">{{ingredient}}</span>
          }
        </div>
        <span class="date">{{ record.date | date:'short' }}</span>
      </div>
    }
  } @else {
    <div class="container-placeholder">
      <span class="title" style="top: 3rem;">Aún no has buscado recetas</span>
      <img class="placeholder-img" src="assets\images\books.png" alt="">
    </div>
  }
</div>
